<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.eats.mapper.store.storeMenuMapper">

	<select id="storeCateList" resultType="com.eats.store.model.MenuDTO">
		select * from MENU_CATE_TEST
	</select>
	
	
	<select id="storeMenuList" parameterType="Integer" resultType="com.eats.store.model.MenuDTO">
		select * 
		from 
		MENU_TEST
		<if test="idx!=0">
			where m_cate_idx = #{idx}
		</if>
	</select>
	
	
	<insert id="insertMenu" parameterType="com.eats.store.model.MenuDTO">
	      INSERT INTO 
        menu_test (MENU_IDX, M_CATE_IDX, MENU_NAME, MENU_PRICE, MENU_INFO, MENU_PREORDER, MENU_IMAGE_IDX)
        VALUES (
            MENU_IDX_SEQ.NEXTVAL, 
            #{m_cate_idx},
            #{menu_name},
            #{menu_price},
            #{menu_info},
            #{menu_preorder},
            #{menu_img_idx}
        )
	</insert>
	
	
	<!-- 이미지 등록 -->
	<insert id="insertMenuImg" parameterType="com.eats.store.model.MenuImgDTO">
      INSERT INTO 
        MENU_IMAGE (MENU_IMAGE_IDX, ORIGIN_IMAGE_NAME, NEW_IMAGE_NAME, IMAGE_PATH)
        VALUES (
            MENU_IMAGE_IDX.NEXTVAL,
            #{origin_image_name},
            #{new_image_name},
            #{image_path}
        )
	</insert>
	
	
	<delete id="deleteMenuCate" parameterType="String">
	delete 
	from
	MENU_CATE_TEST
	where
	m_cate_name=#{m_cate_name}	
	</delete>
	
	
	<!-- 카테고리 등록 -->
	<insert id="insertCate" parameterType="String">
	
	 insert into 
	 MENU_CATE_TEST
	 values(
	 M_CATE_IDX_SEQ.NEXTVAL, 
	 STORE_IDX_SEQ.NEXTVAL,
	 #{m_cate_name}
	 )
	</insert>
	
	
	
	<!-- 선택한 메뉴삭제 -->
	<delete id="deleteMenu" parameterType="java.util.List">
		
		delete from
		menu_test
		where
		menu_idx in 
		<foreach item="menu_idx" collection="list" open="(" separator="," close=")">
			#{menu_idx}
		</foreach>
		
	</delete>
	
	
	
	<!-- 메뉴 수정 -->
	<update id="updateMenu" parameterType="com.eats.store.model.MenuDTO">
		update
		menu_test
		set
		m_cate_idx=#{m_cate_idx},
		menu_name=#{menu_name},
		menu_price=#{menu_price},
		menu_info=#{menu_info},
		menu_preorder=#{menu_preorder},
		menu_image_idx=#{menu_image_idx}
		where
		menu_idx=#{menu_idx}		
	</update>
	
	
</mapper>

